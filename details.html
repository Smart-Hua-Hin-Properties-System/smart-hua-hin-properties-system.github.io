<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details - Smart System</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #1a5276; --bg: #f4f7f6; --text: #2c3e50; --white: #ffffff; --green: #27ae60; --gold: #f1c40f; }
        body { font-family: 'Kanit', sans-serif; background-color: var(--bg); margin: 0; padding: 0; color: var(--text); line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; background: var(--white); min-height: 100vh; padding-bottom: 120px; box-shadow: 0 0 30px rgba(0,0,0,0.1); }
        
        /* Navigation */
        .back-nav { padding: 15px; background: #fff; position: sticky; top: 0; z-index: 1000; border-bottom: 1px solid #eee; }
        .back-btn { text-decoration: none; color: var(--primary); font-weight: 600; display: flex; align-items: center; gap: 8px; font-size: 1.1rem; }
        
        /* Identity Badge On Hero */
        .hero-box { position: relative; width: 100%; height: 380px; overflow: hidden; }
        .main-img { width: 100%; height: 100%; object-fit: cover; background: #ececec; }
        .hero-badge { 
            position: absolute; top: 15px; left: 15px; background: var(--green); color: white;
            padding: 6px 15px; border-radius: 50px; font-weight: 600; font-size: 0.85rem;
            box-shadow: 0 4px 10px rgba(0,0,0,0.25); z-index: 10;
        }

        .content { padding: 25px; }
        .price-box { font-size: 2.6rem; color: var(--primary); font-weight: 600; margin: 5px 0 20px 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; }
        
        /* üöÄ Restoration: 19 Data Grid Items */
        .info-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 12px; margin-top: 20px; }
        .info-item { display: flex; align-items: center; gap: 12px; padding: 12px; background: #f8f9fa; border-radius: 12px; border-left: 4px solid var(--primary); }
        .info-item i { font-size: 1.1rem; color: var(--primary); width: 22px; text-align: center; }
        .info-label { color: #7f8c8d; font-size: 0.8rem; display: block; }
        .info-value { font-weight: 600; font-size: 0.95rem; }
        .full-width { grid-column: 1 / -1; }

        /* Master Plan Downloader */
        .download-section { padding: 25px; text-align: center; }
        .btn-download { 
            display: inline-flex; align-items: center; gap: 10px; background: var(--primary); color: white;
            padding: 14px 30px; border-radius: 12px; text-decoration: none; font-weight: 600; transition: 0.3s;
        }

        /* Centered 8 Icons Share with Icon Symbol */
        .share-section { padding: 30px 0; border-top: 1px dashed #ddd; text-align: center; }
        .share-symbol { font-size: 1.6rem; color: #7f8c8d; margin-bottom: 15px; display: block; }
        .share-bar { 
            display: flex; gap: 15px; overflow-x: auto; padding: 10px 20px 30px; 
            justify-content: flex-start; scrollbar-width: none; -webkit-overflow-scrolling: touch;
        }
        .share-bar::-webkit-scrollbar { display: none; }
        .share-btn { 
            width: 52px; height: 52px; border-radius: 50%; border: none; background: #fff; 
            flex-shrink: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center;
        }
        .share-btn img { width: 28px; height: 28px; }

        /* Full Portfolio Grid (2 Columns) */
        .related-section { padding: 25px 20px; background: #f0f2f5; }
        .related-title { font-weight: 600; margin-bottom: 20px; color: var(--primary); display: flex; align-items: center; gap: 10px; }
        .related-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .mini-card { background: #fff; border-radius: 15px; overflow: hidden; box-shadow: 0 4px 12px rgba(0,0,0,0.05); cursor: pointer; position: relative; }
        .mini-img { width: 100%; height: 130px; object-fit: cover; }
        .mini-info { padding: 12px; }
        .mini-id { position: absolute; top: 8px; left: 8px; background: var(--green); color: white; padding: 2px 8px; border-radius: 50px; font-size: 0.65rem; font-weight: 600; }
        .mini-price { color: var(--primary); font-weight: 600; font-size: 0.95rem; }

        .footer-action { position: fixed; bottom: 0; width: 100%; max-width: 600px; background: #fff; padding: 18px; box-sizing: border-box; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); z-index: 1000; }
        .btn-line { display: flex; align-items: center; justify-content: center; gap: 10px; background: #00b900; color: #fff; padding: 16px; border-radius: 15px; text-decoration: none; font-weight: 600; font-size: 1.2rem; }
        
        #loader { text-align: center; padding: 150px 20px; color: var(--primary); font-size: 1.2rem; }
    </style>
</head>
<body>

<div class="container" id="mainWrapper">
    <div id="loader"><i class="fas fa-spinner fa-spin fa-2x"></i><br><br>‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏î‡∏∂‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Smart System...</div>
</div>

<script>
    const api = "https://script.google.com/macros/s/AKfycbza29YWiI0PkYfgQPhRmVNr2IH4S3lF_XmKgRUO2GRqa9BCfIUm3ynv4RH81RjEjilm/exec";
    const pId = new URLSearchParams(window.location.search).get('id');

    async function load() {
        try {
            const r = await fetch(api);
            const d = await r.json();
            const it = d.find(x => x.HP_ID === pId);
            if(it) render(it, d);
        } catch(e) { document.getElementById('loader').innerHTML = "‚ùå ‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏•‡πâ‡∏°‡πÄ‡∏´‡∏•‡∏ß"; }
    }

    function share(platform, name, price) {
        const url = window.location.href;
        const msg = `üè° ${name}\nüí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤: ‡∏ø${price}\n‡∏ä‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î: ${url}`;
        if(platform === 'copy') { navigator.clipboard.writeText(msg); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!'); return; }
        const links = {
            line: `https://line.me/R/msg/text/?${encodeURIComponent(msg)}`,
            fb: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
            msg: `fb-messenger://share/?link=${encodeURIComponent(url)}`,
            wa: `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`,
            tg: `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(name)}`,
            sms: `sms:?body=${encodeURIComponent(msg)}`,
            mail: `mailto:?subject=${encodeURIComponent(name)}&body=${encodeURIComponent(msg)}`
        };
        window.open(links[platform]);
    }

    function render(it, all) {
        const wrap = document.getElementById('mainWrapper');
        const fP = Number(it.Price).toLocaleString();
        // Restoration: Fetch all properties in the same project without slicing
        const related = all.filter(x => x.Project_Name === it.Project_Name && x.HP_ID !== it.HP_ID);

        wrap.innerHTML = `
            <div class="back-nav"><a href="javascript:history.back()" class="back-btn"><i class="fas fa-arrow-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Ñ‡∏ï‡∏ï‡∏≤‡∏•‡πá‡∏≠‡∏Å</a></div>
            
            <div class="hero-box">
                <div class="hero-badge">${it.HP_ID} - ${it.ID}</div>
                <img src="${it.Thumbnail}" class="main-img" onerror="this.src='https://placehold.co/600x400?text=Smart+System'">
            </div>

            <div class="content">
                <div style="display:flex; gap:8px; margin-bottom:10px;">
                    ${it.Badge ? `<span style="background:var(--gold); color:#000; padding:2px 10px; border-radius:5px; font-size:0.75rem; font-weight:600;">${it.Badge}</span>` : ''}
                    ${it.Status ? `<span style="background:var(--green); color:#fff; padding:2px 10px; border-radius:5px; font-size:0.75rem; font-weight:600;">${it.Status}</span>` : ''}
                </div>
                <h1 style="margin:0; font-size:1.8rem; color:var(--primary);">${it.Project_Name}</h1>
                <p style="color:#7f8c8d; margin:5px 0 20px 0;">‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∞‡∏ö‡∏ö: ${it.HP_ID} | ‡πÅ‡∏õ‡∏•‡∏á: ${it.Plot || '-'}</p>
                <div class="price-box">‡∏ø${fP}</div>

                <div class="info-grid">
                    <div class="info-item"><i class="fas fa-house"></i><div><span class="info-label">‡∏õ‡∏£‡∏∞‡πÄ‡∏†‡∏ó</span><span class="info-value">${it.Type || '-'}</span></div></div>
                    <div class="info-item"><i class="fas fa-bed"></i><div><span class="info-label">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô</span><span class="info-value">${it.Bedrooms || 0}</span></div></div>
                    <div class="info-item"><i class="fas fa-bath"></i><div><span class="info-label">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥</span><span class="info-value">${it.Bathrooms || 0}</span></div></div>
                    <div class="info-item"><i class="fas fa-vector-square"></i><div><span class="info-label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢</span><span class="info-value">${it['Living Area (sq.m)'] || 0} m¬≤</span></div></div>
                    <div class="info-item"><i class="fas fa-maximize"></i><div><span class="info-label">‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô (sq.w)</span><span class="info-value">${it['Land Area (sq.w)'] || 0}</span></div></div>
                    <div class="info-item"><i class="fas fa-ruler-combined"></i><div><span class="info-label">‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô (sq.m)</span><span class="info-value">${it['Land Area (sq.m)'] || 0}</span></div></div>
                    <div class="info-item"><i class="fas fa-swimming-pool"></i><div><span class="info-label">‡∏Ç‡∏ô‡∏≤‡∏î‡∏™‡∏£‡∏∞</span><span class="info-value">${it['Pool Size'] || '-'}</span></div></div>
                    <div class="info-item"><i class="fas fa-water"></i><div><span class="info-label">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏•‡∏∂‡∏Å‡∏™‡∏£‡∏∞</span><span class="info-value">${it['Pool Depth'] || '-'}</span></div></div>
                    <div class="info-item"><i class="fas fa-couch"></i><div><span class="info-label">‡πÄ‡∏ü‡∏≠‡∏£‡πå‡∏ô‡∏¥‡πÄ‡∏à‡∏≠‡∏£‡πå</span><span class="info-value">${it.Furnishing || '-'}</span></div></div>
                    <div class="info-item"><i class="fas fa-car"></i><div><span class="info-label">‡∏ó‡∏µ‡πà‡∏à‡∏≠‡∏î‡∏£‡∏ñ</span><span class="info-value">${it.Parking || '-'} ‡∏Ñ‡∏±‡∏ô</span></div></div>
                    <div class="info-item"><i class="fas fa-bolt"></i><div><span class="info-label">‡∏£‡∏∞‡∏ö‡∏ö‡πÑ‡∏ü‡∏ü‡πâ‡∏≤</span><span class="info-value">${it.Electricity || '-'}</span></div></div>
                    <div class="info-item"><i class="fas fa-location-dot"></i><div><span class="info-label">‡∏ó‡∏≥‡πÄ‡∏•</span><span class="info-value">${it.SubDistrict}, ${it.District}</span></div></div>
                    <div class="info-item full-width"><i class="fas fa-star"></i><div><span class="info-label">‡∏Ç‡∏≠‡∏á‡πÅ‡∏ñ‡∏°/‡∏û‡∏¥‡πÄ‡∏®‡∏© (Extras)</span><span class="info-value">${it.Extras || '-'}</span></div></div>
                </div>

                <div style="margin-top:30px; background:#fff9f0; padding:20px; border-radius:15px; border:1px solid #ffeeba;">
                    <b style="color:var(--primary);"><i class="fas fa-file-lines"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å:</b>
                    <p style="margin:10px 0 0 0; font-size:0.95rem;">${it.Description || '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï'}</p>
                </div>
            </div>

            <div class="download-section">
                <a href="${it.FloorPlan || '#'}" class="btn-download" target="_blank">
                    <i class="fas fa-download"></i> ‡∏î‡∏≤‡∏ß‡∏ô‡πå‡πÇ‡∏´‡∏•‡∏î‡∏°‡∏≤‡∏™‡πÄ‡∏ï‡∏≠‡∏£‡πå‡πÅ‡∏û‡∏•‡∏ô
                </a>
            </div>

            <div class="share-section">
                <i class="fas fa-share-alt share-symbol"></i>
                <div class="share-bar">
                    <button class="share-btn" onclick="share('line','${it.Project_Name}','${fP}')"><img src="https://upload.wikimedia.org/wikipedia/commons/4/41/LINE_logo.svg"></button>
                    <button class="share-btn" onclick="share('fb','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/733/733547.png"></button>
                    <button class="share-btn" onclick="share('msg','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/5968/5968771.png"></button>
                    <button class="share-btn" onclick="share('wa','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png"></button>
                    <button class="share-btn" onclick="share('tg','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png"></button>
                    <button class="share-btn" onclick="share('sms','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/813/813636.png"></button>
                    <button class="share-btn" onclick="share('mail','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/732/732200.png"></button>
                    <button class="share-btn" onclick="share('copy','${it.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/1621/1621635.png"></button>
                </div>
            </div>

            <div class="related-section">
                <div class="related-title"><i class="fas fa-layer-group"></i> ‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÜ ‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡πÄ‡∏î‡∏µ‡∏¢‡∏ß‡∏Å‡∏±‡∏ô</div>
                <div class="related-grid">
                    ${related.map(r => `
                        <div class="mini-card" onclick="window.location.href='details.html?id=${r.HP_ID}'; window.scrollTo(0,0);">
                            <div class="mini-id">${r.ID}</div>
                            <img src="${r.Thumbnail}" class="mini-img" onerror="this.src='https://placehold.co/200x150?text=Smart+System'">
                            <div class="mini-info">
                                <div class="mini-price">‡∏ø${Number(r.Price).toLocaleString()}</div>
                                <div style="font-size:0.75rem; color:#7f8c8d;">üõå ${r.Bedrooms} | üìê ${r['Living Area (sq.m)']}m¬≤</div>
                            </div>
                        </div>
                    `).join('')}
                </div>
            </div>

            <div class="footer-action">
                <a href="https://line.me/R/msg/text/?‡∏™‡∏ô‡πÉ‡∏à‡∏£‡∏´‡∏±‡∏™: ${it.HP_ID} ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£: ${it.Project_Name}" class="btn-line">
                    <i class="fab fa-line"></i> ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô LINE
                </a>
            </div>
        `;
    }
    load();
</script>
</body>
</html>


