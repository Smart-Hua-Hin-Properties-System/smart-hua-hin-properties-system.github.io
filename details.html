<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Property Details - Smart System</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root { --primary: #1a5276; --bg: #f4f7f6; --text: #2c3e50; --white: #ffffff; }
        body { font-family: 'Kanit', sans-serif; background-color: var(--bg); margin: 0; padding: 0; color: var(--text); line-height: 1.6; }
        .container { max-width: 600px; margin: 0 auto; background: var(--white); min-height: 100vh; padding-bottom: 120px; box-shadow: 0 0 30px rgba(0,0,0,0.1); }
        
        /* Navigation */
        .back-nav { padding: 15px; background: #fff; position: sticky; top: 0; z-index: 100; border-bottom: 1px solid #eee; display: flex; align-items: center; }
        .back-btn { text-decoration: none; color: var(--primary); font-weight: 600; display: flex; align-items: center; gap: 8px; font-size: 1.1rem; }
        
        /* Media */
        .main-img { width: 100%; height: 380px; object-fit: cover; background: #ececec; }
        
        /* Content */
        .content { padding: 25px; }
        .project-tag { display: inline-block; background: var(--primary); color: white; padding: 4px 15px; border-radius: 50px; font-size: 0.9rem; margin-bottom: 10px; }
        .price-box { font-size: 2.4rem; color: var(--primary); font-weight: 600; margin: 15px 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 15px; }
        
        /* Attribute Mapping 19+ */
        .detail-grid { display: grid; grid-template-columns: 1fr; gap: 15px; margin-top: 20px; }
        .detail-item { display: flex; align-items: center; gap: 15px; padding: 15px; background: #f8f9fa; border-radius: 12px; border-left: 4px solid var(--primary); }
        .detail-item i { font-size: 1.2rem; color: var(--primary); width: 25px; text-align: center; }
        .detail-label { color: #7f8c8d; font-size: 0.9rem; display: block; }
        .detail-value { font-weight: 600; font-size: 1.1rem; }

        /* Description */
        .desc-section { margin-top: 30px; padding: 20px; background: #fff9f0; border-radius: 12px; border: 1px solid #ffeeba; }

        /* üöÄ 8 ‡∏°‡∏´‡∏≤‡∏≠‡∏≥‡∏ô‡∏≤‡∏à Share Bar */
        .share-section { padding: 30px 0; border-top: 1px dashed #ddd; text-align: center; }
        .share-bar { display: flex; gap: 12px; overflow-x: auto; padding: 10px 25px 25px; justify-content: flex-start; scrollbar-width: none; }
        .share-bar::-webkit-scrollbar { display: none; }
        .share-btn { width: 52px; height: 52px; border-radius: 50%; border: none; background: #fff; flex-shrink: 0; box-shadow: 0 4px 12px rgba(0,0,0,0.1); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: 0.3s; }
        .share-btn:active { transform: scale(0.9); }
        .share-btn img { width: 28px; height: 28px; }

        /* Related Properties */
        .related-section { padding: 25px 20px; background: #f0f2f5; }
        .related-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 15px; }
        .mini-card { background: #fff; border-radius: 12px; overflow: hidden; box-shadow: 0 4px 10px rgba(0,0,0,0.05); cursor: pointer; }
        .mini-img { width: 100%; height: 120px; object-fit: cover; }
        .mini-info { padding: 10px; font-size: 0.9rem; }
        
        /* Footer Action */
        .footer-action { position: fixed; bottom: 0; width: 100%; max-width: 600px; background: #fff; padding: 20px; box-sizing: border-box; box-shadow: 0 -5px 20px rgba(0,0,0,0.1); z-index: 1000; }
        .btn-line { display: flex; align-items: center; justify-content: center; gap: 10px; background: #00b900; color: #fff; text-align: center; padding: 16px; border-radius: 15px; text-decoration: none; font-weight: 600; font-size: 1.2rem; }
        
        #loader { text-align: center; padding: 150px 20px; font-size: 1.2rem; color: var(--primary); }
    </style>
</head>
<body>
<div class="container" id="mainWrapper">
    <div id="loader"><i class="fas fa-spinner fa-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏™‡∏ñ‡∏≤‡∏ô‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• Smart System...</div>
</div>

<script>
    const api = "https://script.google.com/macros/s/AKfycbyUMPlMZfqtoWVikxCV_XECQHmimWg4hXo1PRFb2SfMEINvwOOADJZHeQ-MDNCBBbBV/exec";
    const pId = new URLSearchParams(window.location.search).get('id');

    async function load() {
        try {
            const r = await fetch(api);
            const d = await r.json();
            const it = d.find(x => x.HP_ID === pId);
            if(it) render(it, d);
            else document.getElementById('loader').innerText = "‚ùå ‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏£‡∏´‡∏±‡∏™‡∏ô‡∏µ‡πâ‡πÉ‡∏ô‡∏£‡∏∞‡∏ö‡∏ö";
        } catch(e) { document.getElementById('loader').innerText = "‚ùå ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ê‡∏≤‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•"; }
    }

    function share(platform, name, price) {
        const url = window.location.href;
        const msg = `üè° ${name}\nüí∞ ‡∏£‡∏≤‡∏Ñ‡∏≤: ‡∏ø${price}\n‡∏ä‡∏°‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏û‡∏£‡∏µ‡πÄ‡∏°‡∏µ‡∏¢‡∏°: ${url}`;
        if(platform === 'copy') { navigator.clipboard.writeText(msg); alert('‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå‡πÄ‡∏£‡∏µ‡∏¢‡∏ö‡∏£‡πâ‡∏≠‡∏¢!'); return; }
        const links = {
            line: `https://line.me/R/msg/text/?${encodeURIComponent(msg)}`,
            fb: `https://www.facebook.com/sharer/sharer.php?u=${encodeURIComponent(url)}`,
            msg: `fb-messenger://share/?link=${encodeURIComponent(url)}`,
            wa: `https://api.whatsapp.com/send?text=${encodeURIComponent(msg)}`,
            tg: `https://t.me/share/url?url=${encodeURIComponent(url)}&text=${encodeURIComponent(name)}`,
            sms: `sms:?body=${encodeURIComponent(msg)}`,
            mail: `mailto:?subject=${encodeURIComponent(name)}&body=${encodeURIComponent(msg)}`
        };
        window.open(links[platform]);
    }

    function render(item, all) {
        const wrap = document.getElementById('mainWrapper');
        const fP = Number(item.Price).toLocaleString();
        const others = all.filter(x => x.HP_ID !== pId && x.Project_Name === item.Project_Name && x.HP_ID).slice(0, 10);

        wrap.innerHTML = `
            <div class="back-nav"><a href="javascript:history.back()" class="back-btn"><i class="fas fa-chevron-left"></i> ‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏Ñ‡∏ï‡∏ï‡∏≤‡∏•‡πá‡∏≠‡∏Å</a></div>
            <img src="${item.Thumbnail}" class="main-img" onerror="this.src='https://placehold.co/600x400?text=Smart+Hua+Hin+Properties+System'">
            <div class="content">
                <span class="project-tag">${item.Project_Name}</span>
                <h1 style="margin:0 0 10px 0; font-size:1.8rem; color:var(--primary);">${item.Project_Name} (‡πÅ‡∏õ‡∏•‡∏á ${item.Plot || '-'})</h1>
                <p style="color:#7f8c8d; margin:0 0 20px 0;">‡∏£‡∏´‡∏±‡∏™‡∏£‡∏∞‡∏ö‡∏ö: <b>${item.HP_ID}</b> | ‡∏£‡∏´‡∏±‡∏™‡∏Å‡∏≤‡∏£‡∏ï‡∏•‡∏≤‡∏î: <b>${item.ID}</b></p>
                <div class="price-box">‡∏ø${fP}</div>
                
                <div class="detail-grid">
                    <div class="detail-item"><i class="fas fa-bed"></i><div><span class="detail-label">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô</span><span class="detail-value">${item.Bedrooms || '0'} ‡∏´‡πâ‡∏≠‡∏á</span></div></div>
                    <div class="detail-item"><i class="fas fa-bath"></i><div><span class="detail-label">‡∏´‡πâ‡∏≠‡∏á‡∏ô‡πâ‡∏≥</span><span class="detail-value">${item.Bathrooms || '0'} ‡∏´‡πâ‡∏≠‡∏á</span></div></div>
                    <div class="detail-item"><i class="fas fa-expand-arrows-alt"></i><div><span class="detail-label">‡∏û‡∏∑‡πâ‡∏ô‡∏ó‡∏µ‡πà‡πÉ‡∏ä‡πâ‡∏™‡∏≠‡∏¢</span><span class="detail-value">${item['Living Area (sq.m)'] || '0'} ‡∏ï‡∏£.‡∏°.</span></div></div>
                    <div class="detail-item"><i class="fas fa-tree"></i><div><span class="detail-label">‡∏ó‡∏µ‡πà‡∏î‡∏¥‡∏ô</span><span class="detail-value">${item['Land Area (sq.w)'] || '0'} ‡∏ï‡∏£.‡∏ß.</span></div></div>
                    <div class="detail-item"><i class="fas fa-map-marker-alt"></i><div><span class="detail-label">‡∏ó‡∏≥‡πÄ‡∏•‡∏®‡∏±‡∏Å‡∏¢‡∏†‡∏≤‡∏û</span><span class="detail-value">${item.SubDistrict}, ${item.District}</span></div></div>
                </div>

                <div class="desc-section">
                    <b style="color:var(--primary);"><i class="fas fa-info-circle"></i> ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡πÄ‡∏ä‡∏¥‡∏á‡∏•‡∏∂‡∏Å:</b>
                    <p style="margin:10px 0 0 0; font-size:1rem; color:#444;">${item.Description || '‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ñ‡∏π‡∏Å‡∏≠‡∏±‡∏õ‡πÄ‡∏î‡∏ï‡πÇ‡∏î‡∏¢ Master Admin ‡πÇ‡∏õ‡∏£‡∏î‡∏ï‡∏¥‡∏î‡∏ï‡πà‡∏≠‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î'}</p>
                </div>
            </div>

            <div class="share-section">
                <p style="font-weight:600; color:#7f8c8d; margin-bottom:15px;"><i class="fas fa-share-alt"></i> ‡∏™‡πà‡∏á‡∏ï‡πà‡∏≠‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏î‡πâ‡∏ß‡∏¢ 8 ‡∏°‡∏´‡∏≤‡∏≠‡∏≥‡∏ô‡∏≤‡∏à‡∏Å‡∏≤‡∏£‡πÅ‡∏ä‡∏£‡πå</p>
                <div class="share-bar">
                    <button class="share-btn" title="LINE" onclick="share('line','${item.Project_Name}','${fP}')"><img src="https://upload.wikimedia.org/wikipedia/commons/4/41/LINE_logo.svg"></button>
                    <button class="share-btn" title="Facebook" onclick="share('fb','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/733/733547.png"></button>
                    <button class="share-btn" title="Messenger" onclick="share('msg','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/5968/5968771.png"></button>
                    <button class="share-btn" title="WhatsApp" onclick="share('wa','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/733/733585.png"></button>
                    <button class="share-btn" title="Telegram" onclick="share('tg','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/2111/2111646.png"></button>
                    <button class="share-btn" title="SMS" onclick="share('sms','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/813/813636.png"></button>
                    <button class="share-btn" title="Email" onclick="share('mail','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/732/732200.png"></button>
                    <button class="share-btn" title="‡∏Ñ‡∏±‡∏î‡∏•‡∏≠‡∏Å‡∏•‡∏¥‡∏á‡∏Å‡πå" onclick="share('copy','${item.Project_Name}','${fP}')"><img src="https://cdn-icons-png.flaticon.com/512/1621/1621635.png"></button>
                </div>
            </div>
            
            <div class="related-section">
                <div style="font-weight:600; margin-bottom:15px; color:var(--primary);"><i class="fas fa-home"></i> ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ${item.Project_Name}</div>
                <div class="related-grid" id="relGrid"></div>
            </div>
            
            <div class="footer-action">
                <a href="https://line.me/R/msg/text/?‡∏™‡∏ß‡∏±‡∏™‡∏î‡∏µ‡∏Ñ‡∏£‡∏±‡∏ö ‡∏™‡∏ô‡πÉ‡∏à‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡πÄ‡∏ï‡∏¥‡∏°‡∏£‡∏´‡∏±‡∏™: ${item.HP_ID} ‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£ ${item.Project_Name}" class="btn-line">
                    <i class="fab fa-line"></i> ‡∏™‡∏≠‡∏ö‡∏ñ‡∏≤‡∏°‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ú‡πà‡∏≤‡∏ô LINE
                </a>
            </div>
        `;

        const rG = document.getElementById('relGrid');
        if(others.length === 0) {
            rG.innerHTML = `<div style="grid-column:1/-1; color:#999; text-align:center; padding:20px;">‡πÑ‡∏°‡πà‡∏û‡∏ö‡∏ó‡∏£‡∏±‡∏û‡∏¢‡πå‡∏≠‡∏∑‡πà‡∏ô‡πÉ‡∏ô‡πÇ‡∏Ñ‡∏£‡∏á‡∏Å‡∏≤‡∏£‡∏ô‡∏µ‡πâ</div>`;
        } else {
            others.forEach(o => {
                const div = document.createElement('div');
                div.className = 'mini-card';
                div.onclick = () => { window.location.href = `details.html?id=${o.HP_ID}`; window.scrollTo(0,0); };
                div.innerHTML = `
                    <img src="${o.Thumbnail}" class="mini-img" onerror="this.src='https://placehold.co/200x150?text=CoCo+Luxury'">
                    <div class="mini-info"><b>${o.ID}</b><br><span style="color:var(--primary); font-weight:600;">‡∏ø${Number(o.Price).toLocaleString()}</span></div>
                `;
                rG.appendChild(div);
            });
        }
    }
    load();
</script>
</body>
</html>
