"<!DOCTYPE html>
<html lang=""th"">
<head>
  <meta charset=""UTF-8"">
  <meta name=""viewport"" content=""width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no"">
  <title>SMART PROPERTY | CATALOG V101.0</title>
  <link href=""https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500;600;900&display=swap"" rel=""stylesheet"">
  <link rel=""stylesheet"" href=""https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"">
  <style>
    :root { --primary:#1a5276; --bg:#9CBCE3; --white:#ffffff; --green:#00d44b; --badge-bg:#154360; }
    html, body { font-family:'Kanit',sans-serif; background:var(--bg); margin:0; padding:0; overflow-x:hidden; width:100%; }
    * { box-sizing:border-box; }

    /* Loader */
    #loader { position:fixed; inset:0; background:var(--bg); display:flex; align-items:center; justify-content:center; z-index:9999; transition:0.5s; }

    /* Header */
    header { background:#fff; padding:12px 15px; display:flex; align-items:center; justify-content:space-between; position:sticky; top:0; z-index:1000; box-shadow:0 2px 10px rgba(0,0,0,0.1); width:100%; }
    .header-left { display:flex; align-items:center; gap:8px; cursor:pointer; color:var(--primary); }
    .flag-list { display:flex; gap:5px; }
    .flag-btn { border:none; background:none; padding:0; cursor:pointer; }
    .flag-btn img { width:24px; height:16px; border-radius:2px; }

    /* Filter */
    .filter-area { padding:15px; width:100%; max-width:1200px; margin:0 auto; }
    .filter-grid { display:grid; grid-template-columns:1fr 1fr; gap:10px; background:rgba(255,255,255,0.9); padding:15px; border-radius:25px; box-shadow:0 8px 20px rgba(0,0,0,0.05); }
    @media (min-width:768px){ .filter-grid{ grid-template-columns:repeat(4,1fr);} }
    .select-box { width:100%; padding:12px; border-radius:12px; border:1px solid #ddd; font-family:'Kanit'; color:var(--primary); font-size:0.85rem; background:white; outline:none; }

    /* Cards */
    .property-grid { display:grid; grid-template-columns:repeat(auto-fill,minmax(300px,1fr)); gap:20px; padding:0 15px 40px; max-width:1200px; margin:0 auto; }
    .card { background:var(--white); border-radius:40px; overflow:hidden; position:relative; box-shadow:0 15px 35px rgba(0,0,0,0.1); transition:0.3s; cursor:pointer; }
    .badge-hp { position:absolute; top:15px; left:15px; background:var(--badge-bg); color:white; padding:5px 15px; border-radius:10px; font-size:0.75rem; font-weight:600; z-index:10; }
    .card-img { width:100%; height:350px; object-fit:cover; background:#eee; }
    .card-body { padding:25px; text-align:left; }
    .house-id-text { font-size:1.8rem; font-weight:900; color:var(--primary); margin-bottom:2px; text-transform:uppercase; }
    .project-name { font-size:0.85rem; color:#888; margin-bottom:12px; font-weight:500; }
    .price-text { font-size:1.6rem; color:var(--primary); font-weight:700; margin-bottom:15px; display:block; }
    .btn-detail { display:block; width:100%; padding:12px; background:var(--primary); color:white; text-align:center; border-radius:50px; text-decoration:none; font-weight:500; }
  </style>
</head>
<body>

<div id=""loader""><h2 style=""color:white; font-weight:900;"">üè† ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•...</h2></div>

<header>
  <div class=""header-left"">
    <i class=""fas fa-bars fa-lg""></i>
    <span style=""font-size:0.85rem; font-weight:500; margin-left:5px;"">‡πÄ‡∏°‡∏ô‡∏π</span>
  </div>
  <div style=""font-weight:900; color:var(--primary); font-size:1.1rem; letter-spacing:-0.5px;"">HUAHIN.PROPERTIES</div>
  <div class=""flag-list"">
    <button class=""flag-btn"" onclick=""setLanguage('th')""><img src=""https://flagcdn.com/w40/th.png"" alt=""TH""></button>
    <button class=""flag-btn"" onclick=""setLanguage('en')""><img src=""https://flagcdn.com/w40/us.png"" alt=""EN""></button>
  </div>
</header>

<div class=""filter-area"">
  <div class=""filter-grid"">
    <select class=""select-box"" id=""distFilter"" onchange=""updateSubDistricts()"">
      <option value="""">üìç ‡∏≠‡∏≥‡πÄ‡∏†‡∏≠‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
      <option value=""‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô"">‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô</option>
      <option value=""‡∏ä‡∏∞‡∏≠‡∏≥"">‡∏ä‡∏∞‡∏≠‡∏≥</option>
      <option value=""‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ"">‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ</option>
    </select>

    <select class=""select-box"" id=""subDistFilter"" onchange=""applyFilters()"">
      <option value="""">üèòÔ∏è ‡∏ï‡∏≥‡∏ö‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
    </select>

    <select class=""select-box"" id=""bedFilter"" onchange=""applyFilters()"">
      <option value="""">üõå ‡∏´‡πâ‡∏≠‡∏á‡∏ô‡∏≠‡∏ô‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>
      <option value=""1"">1 Bed</option>
      <option value=""2"">2 Beds</option>
      <option value=""3"">3 Beds</option>
      <option value=""4"">4+ Beds</option>
    </select>

    <select class=""select-box"" id=""priceSort"" onchange=""applyFilters()"">
      <option value="""">üí∞ ‡πÄ‡∏£‡∏µ‡∏¢‡∏á‡∏ï‡∏≤‡∏°‡∏£‡∏≤‡∏Ñ‡∏≤</option>
      <option value=""low"">‡∏ô‡πâ‡∏≠‡∏¢‡πÑ‡∏õ‡∏°‡∏≤‡∏Å</option>
      <option value=""high"">‡∏°‡∏≤‡∏Å‡πÑ‡∏õ‡∏ô‡πâ‡∏≠‡∏¢</option>
    </select>
  </div>
</div>

<div class=""property-grid"" id=""grid""></div>

<script>
  const api = ""https://script.google.com/macros/s/AKfycbyS8rGtSnhVS8RdWje7icXZVCw5iBBJoWkEpOYm649OC6FOhnrVi87dD9GsJl_m_FVw/exec"";
  let allData = [];

  // ‡∏Å‡∏±‡∏ô error ‡∏ñ‡πâ‡∏≤‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏ó‡∏≥‡∏£‡∏∞‡∏ö‡∏ö‡∏†‡∏≤‡∏©‡∏≤
  function setLanguage(){}

  async function init() {
    try {
      const res = await fetch(`${api}?role=PUBLIC`);
      allData = await res.json();

      // ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô: ‡πÇ‡∏´‡∏•‡∏î‡∏ï‡∏≥‡∏ö‡∏•‡πÅ‡∏ö‡∏ö ""‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î"" ‡πÅ‡∏•‡πâ‡∏ß‡πÇ‡∏ä‡∏ß‡πå‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î
      updateSubDistricts(true);

      document.getElementById('loader').style.display = 'none';
    } catch (e) {
      document.getElementById('loader').style.display = 'none';
      document.getElementById('grid').innerHTML = ""Connection Error"";
    }
  }

  // ‡πÅ‡∏õ‡∏•‡∏á dropdown ‡πÑ‡∏ó‡∏¢ -> ‡∏Ñ‡πà‡∏≤‡∏à‡∏£‡∏¥‡∏á‡πÉ‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (District ‡πÄ‡∏õ‡πá‡∏ô‡∏≠‡∏±‡∏á‡∏Å‡∏§‡∏©)
  function normalizeDistrict(selected) {
    const map = {
      ""‡∏´‡∏±‡∏ß‡∏´‡∏¥‡∏ô"": ""Hua Hin"",
      ""‡∏ä‡∏∞‡∏≠‡∏≥"": ""Cha-am"",
      ""‡∏õ‡∏£‡∏≤‡∏ì‡∏ö‡∏∏‡∏£‡∏µ"": ""Pranburi""
    };
    return map[selected] || selected || """";
  }

  function updateSubDistricts(keepCurrentSub = false) {
    const distSelect = document.getElementById('distFilter');
    const subDistSelect = document.getElementById('subDistFilter');

    const selectedDist = normalizeDistrict(distSelect.value);
    const currentSub = subDistSelect.value;

    subDistSelect.innerHTML = '<option value="""">üèòÔ∏è ‡∏ï‡∏≥‡∏ö‡∏•‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î</option>';

    let dataForSub = [...allData];
    if (selectedDist) {
      dataForSub = dataForSub.filter(it => String(it.District || """").trim() === selectedDist);
    }

    const subDistricts = [...new Set(
      dataForSub.map(it => String(it.SubDistrict || """").trim())
    )].filter(Boolean).sort((a,b)=>a.localeCompare(b,'th'));

    subDistricts.forEach(sub => {
      const opt = document.createElement('option');
      opt.value = sub;
      opt.textContent = sub;
      subDistSelect.appendChild(opt);
    });

    if (!keepCurrentSub) {
      subDistSelect.value = """";
    } else {
      if (currentSub && subDistricts.includes(currentSub)) subDistSelect.value = currentSub;
    }

    applyFilters();
  }

  function priceNum(x) {
    return Number(String(x || ""0"").replace(/,/g, """")) || 0;
  }

  function renderGrid(items) {
    const grid = document.getElementById('grid');
    grid.innerHTML = """";

    items.forEach(it => {
      const houseId = it.ID || it.HOUSE_ID || """";
      const projectName = it.Project_Name || """";
      const thumb = it.Thumbnail || ""https://placehold.co/600x800"";
      const price = priceNum(it.Price);

      grid.innerHTML += `
        <div class=""card"" onclick=""window.location.href='details.html?id=${it.HP_ID}'"">
          <div class=""badge-hp"">${it.HP_ID || """"}</div>
          <img src=""${thumb}"" class=""card-img"" onerror=""this.src='https://placehold.co/600x800'"">
          <div class=""card-body"">
            <div class=""house-id-text"">${houseId}</div>
            <div class=""project-name"">${projectName}</div>
            <span class=""price-text"">‡∏ø${price.toLocaleString()}</span>
            <div class=""btn-detail"">‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î</div>
          </div>
        </div>
      `;
    });
  }

  function applyFilters() {
    let data = [...allData];

    const d = normalizeDistrict(document.getElementById('distFilter').value);
    const s = document.getElementById('subDistFilter').value;
    const b = document.getElementById('bedFilter').value;
    const sort = document.getElementById('priceSort').value;

    if (d) data = data.filter(it => String(it.District || """").trim() === d);
    if (s) data = data.filter(it => String(it.SubDistrict || """").trim() === s);

    if (b) {
      const bedMin = Number(b);
      data = data.filter(it => Number(it.Bedrooms || 0) >= bedMin);
    }

    if (sort === ""low"") data.sort((a,b) => priceNum(a.Price) - priceNum(b.Price));
    if (sort === ""high"") data.sort((a,b) => priceNum(b.Price) - priceNum(a.Price));

    renderGrid(data);
  }

  window.onload = init;
</script>

</body>
</html>"
