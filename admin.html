<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <title>Admin - SMART SYSTEM</title>
    <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;400;500&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Kanit', sans-serif; background: #f4f7f6; padding: 20px; }
        .form-box { max-width: 600px; margin: 0 auto; background: white; padding: 30px; border-radius: 20px; box-shadow: 0 10px 30px rgba(0,0,0,0.05); }
        input, select, textarea { width: 100%; padding: 12px; margin: 10px 0; border-radius: 10px; border: 1px solid #ddd; box-sizing: border-box; }
        button { width: 100%; padding: 15px; background: #1a5276; color: white; border: none; border-radius: 10px; cursor: pointer; font-size: 1.1rem; }
    </style>
</head>
<body>
<div class="form-box">
    <h2>➕ เพิ่ม/แก้ไข ข้อมูลทรัพย์</h2>
    <form id="propForm">
        <input type="text" name="HP_ID" placeholder="HP_ID (เว้นว่างหากเพิ่มใหม่)">
        <input type="text" name="ID" placeholder="Marketing ID (เช่น M16)" required>
        <input type="text" name="Project_Name" placeholder="ชื่อโครงการ" required>
        <input type="text" name="District" placeholder="อำเภอ" required>
        <input type="text" name="SubDistrict" placeholder="ตำบล" required>
        <input type="text" name="Type" placeholder="ประเภท (เช่น Pool Villa)" required>
        <input type="number" name="Price" placeholder="ราคาขายเต็มจำนวน (เช่น 7500000)" required>
        <input type="number" name="Living Area (sq.m)" placeholder="พื้นที่ใช้สอย (ตร.ม.)" required>
        <input type="number" name="Commission (%)" placeholder="คอมมิชชัน (%)" required>
        <input type="text" name="Thumbnail" placeholder="URL รูปภาพหน้าปก">
        <button type="submit" id="saveBtn">สถาปนาข้อมูล (SAVE)</button>
    </form>
</div>
<script>
    const api = "https://script.google.com/macros/s/AKfycbwUqp_vaFNgUdyARh5WG-S3iRm_x1C4EX0tL8aw12nhKpvYVn3I7SwWmi5s-doiYGYh/exec";
    document.getElementById('propForm').onsubmit = async (e) => {
        e.preventDefault();
        const btn = document.getElementById('saveBtn'); btn.disabled = true; btn.innerText = "กำลังประมวลผล...";
        const data = Object.fromEntries(new FormData(e.target).entries());
        try {
            await fetch(api, { method: 'POST', body: JSON.stringify(data) });
            alert("✅ บันทึกและคำนวณ Financial IQ สำเร็จ!");
            e.target.reset();
        } catch(e) { alert("❌ ขัดข้อง"); }
        btn.disabled = false; btn.innerText = "สถาปนาข้อมูล (SAVE)";
    };
</script>
</body>
</html>
