<!DOCTYPE html>
<html lang="th">
<head>
  <meta charset="UTF-8">
  <title>DASHBOARD | SMART SYSTEM</title>
  <link href="https://fonts.googleapis.com/css2?family=Kanit:wght@300;600&display=swap" rel="stylesheet">
  <style>
    body { font-family: 'Kanit', sans-serif; background: #eef2f5; padding: 30px; }
    .stat-card { background: #fff; padding: 20px; border-radius: 15px; text-align: center; border-bottom: 5px solid #1a5276; }
    .table-box { background: #fff; border-radius: 15px; overflow: hidden; margin-top: 20px; }
    table { width: 100%; border-collapse: collapse; }
    th { background: #1a5276; color: white; padding: 12px; }
    td { padding: 12px; border-bottom: 1px solid #eee; text-align: center; }
  </style>
</head>
<body>

<div class="stat-card">
  <h1 style="margin:0;">HOUSE_ID SUMMARY</h1>
  <p>ระบบบริหารจัดการอสังหาริมทรัพย์</p>
</div>

<div class="table-box">
  <table id="dashTable">
    <thead>
      <tr>
        <th>HP_ID</th>
        <th>HOUSE_ID</th>
        <th>โครงการ</th>
        <th>ราคา</th>
        <th>สถานะ</th>
      </tr>
    </thead>
    <tbody></tbody>
  </table>
</div>

<script>
  const API_URL = "https://script.google.com/macros/s/AKfycbyS8rGtSnhVS8RdWje7icXZVCw5iBBJoWkEpOYm649OC6FOhnrVi87dD9GsJl_m_FVw/exec";

  function priceNum(x) {
    return Number(String(x || "0").replace(/,/g, "")) || 0;
  }

  async function fetchStats() {
    const tbody = document.querySelector("#dashTable tbody");
    tbody.innerHTML = "";

    try {
      const res = await fetch(`${API_URL}?role=PUBLIC`);
      const data = await res.json();

      data.forEach(it => {
        const tr = document.createElement("tr");
        tr.innerHTML = `
          <td>${it.HP_ID || ""}</td>
          <td style="font-weight:600; color:#1a5276;">${it.HOUSE_ID || ""}</td>
          <td>${it.Project_Name || ""}</td>
          <td>${priceNum(it.Price).toLocaleString()}</td>
          <td>${it.Status || ""}</td>
        `;
        tbody.appendChild(tr);
      });

    } catch (e) {
      const tr = document.createElement("tr");
      tr.innerHTML = `<td colspan="5">Connection Error</td>`;
      tbody.appendChild(tr);
    }
  }

  window.onload = fetchStats;
</script>
</body>
</html>
